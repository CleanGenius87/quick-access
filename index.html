with open('index.html', 'w', encoding='utf-8') as f:
    f.write('''<!DOCTYPE html>
<!-- Forcing GitHub Pages redeploy to clear cache: 2025-04-29 22:00 BST -->
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>First Bus Quick Access & NOE's</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&display=swap" rel="stylesheet">
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
  
  <!-- PDF Generation for Overtime Form -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  
  <!-- Overtime Form Styles -->
  <link rel="stylesheet" href="overtime.css">
  <style>
    body {
    background: #2c0078;
    font-family: 'Montserrat', Arial, sans-serif;
    color: #fff;
    margin: 0;
    min-height: 100vh;
    }
    .container {
    background: #fff; color: #2c0078; max-width: 520px;
    margin: 64px auto 0 auto; padding: 36px 36px 32px 36px; border-radius: 18px;
    box-shadow: 0 8px 40px rgba(44,0,120,0.11); display: flex; flex-direction: column; align-items: center;
    }
    .logo { width: 180px; margin-bottom: 35px; display: block; }
    .tabs { display: flex; justify-content: center; width: 100%; margin-bottom: 30px; flex-wrap: wrap; }
    .tab { flex: 1; padding: 13px 0; text-align: center;
    background: #ede7fd; color: #2c0078; font-weight: 600; font-size: 1.04rem;
    cursor: pointer; margin: 0 3px 6px 3px; border-radius: 7px 7px 0 0;
    border-bottom: 3px solid transparent; transition: all 0.12s; outline: none;
    min-width: 120px;
    }
    .tab.active { background: #fff; color: #ff44d0; border-bottom: 3px solid #ff44d0; }
    .tab-content { display: none; width: 100%; }
    .tab-content.active { display: block; }
    .dropdown-section, .noe-section { width: 100%; margin-bottom: 24px; }
    label { font-weight: bold; margin-bottom: 8px; display: block; font-size: 1.05rem; color: #2c0078;}
    select, input[type="text"], input[type="time"], input[type="file"], input[type="date"], textarea {
    width: 100%; padding: 10px 12px; border-radius: 7px; border: 1.5px solid #2c0078; font-size: 1rem;
    margin-bottom: 6px; background: #faf7ff; color: #2c0078; font-family: 'Montserrat', Arial, sans-serif;
    }
    textarea { height: 100px; resize: vertical; }
    .actions { margin-top: 14px; width: 100%; display: flex; justify-content: flex-end; gap: 10px; }
    button { border: none; border-radius: 6px; padding: 9px 22px; background: #ff44d0; color: #fff;
    font-weight: 600; font-size: 1rem; cursor: pointer; transition: background 0.16s; min-width: 120px;
    box-shadow: 0 2px 10px rgba(44,0,120,0.04);
    }
    button:disabled { background: #c7b2f7; cursor: not-allowed;}
    .noe-list { margin-top: 20px; margin-bottom: 8px; padding-left: 0px; list-style:none;}
    .noe-list li { background: #ede7fd; border-radius: 6px; padding: 9px 14px 7px 14px; margin-bottom: 9px;
    font-size: 1rem; font-weight: 500; color: #36297d; display: flex; justify-content: space-between; align-items: center;}
    .noe-list a { color: #ff44d0; text-decoration: none; }
    .noe-list button { padding: 5px 10px; min-width: 80px; margin-left: 5px; }
    .noe-buttons { display: flex; justify-content: flex-end; gap: 5px; }
    .footer { color: #faf7ff99; text-align: center; font-size: 0.93rem; margin-top: 48px;}
    .toilet-codes { margin-top: 20px; padding: 10px; background: #ede7fd; border-radius: 6px; }
    .toilet-codes p { margin: 5px 0; font-size: 1rem; color: #36297d; }
    .contact-info { font-size: 0.95rem; color: #d70a33; margin-top: 10px; }
    .handover-content { margin-top: 20px; padding: 10px; background: #ede7fd; border-radius: 6px; width: 100%; }
    .handover-content textarea {
    width: 100%; height: 400px; padding: 10px; border: none; background: transparent;
    font-size: 0.95rem; color: #36297d; resize: none; font-family: 'Montserrat', Arial, sans-serif;
    }
    .route-notes { margin-top: 20px; padding: 10px; background: #ede7fd; border-radius: 6px; }
    .route-notes h3 { margin: 0 0 10px 0; font-size: 1.1rem; color: #2c0078; }
    .route-note { border-bottom: 1px solid #d3d3d3; padding: 8px 0; position: relative; }
    .route-note:last-child { border-bottom: none; }
    .route-note p { margin: 4px 0; font-size: 0.95rem; color: #36297d; }
    .route-note .delete-btn, .route-note .edit-btn, .route-note .copy-btn, .route-note .push-btn {
    border: none; border-radius: 4px; padding: 4px 8px; font-size: 0.9rem; cursor: pointer;
    position: static; display: inline-block; margin-top: 8px; margin-right: 8px;
    }
    .route-note .delete-btn { background: #ff4444; color: #fff; }
    .route-note .edit-btn { background: #44b261; color: #fff; }
    .route-note .copy-btn { background: #4a90e2; color: #fff; }
    .route-note .push-btn { background: #ff44d0; color: #fff; }
    .push-options {
    display: none; margin-top: 10px; width: 100%;
    }
    .push-options.active {
    display: block;
    }
    .driving-hours-section {
    margin-top: 20px; padding: 10px; background: #ede7fd; border-radius: 6px; width: 100%;
    }
    .driving-hours-section h3 { margin: 0 0 10px 0; font-size: 1.1rem; color: #2c0078; }
    .trip-inputs { margin-bottom: 15px; }
    .trip-inputs label { font-size: 0.95rem; }
    .trip-input { margin-bottom: 10px; }
    .routes-checkbox-container {
    max-height: 100px; overflow-y: auto; padding: 10px; border: 1.5px solid #2c0078;
    border-radius: 7px; background: #faf7ff; margin-bottom: 6px;
    }
    .routes-checkbox-container label {
    display: flex; align-items: center; font-weight: 500; font-size: 0.95rem; margin-bottom: 6px;
    color: #36297d;
    }
    .routes-checkbox-container input[type="checkbox"] {
    margin-right: 8px; width: 16px; height: 16px;
    }
    .date-inputs {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
    }
    .date-input {
    flex: 1;
    }
    .noe-edit-modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    }
    .noe-edit-modal-content {
    background-color: #fff;
    margin: 15% auto;
    padding: 20px;
    border-radius: 10px;
    width: 80%;
    max-width: 500px;
    }
    .noe-edit-modal-close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    }
    .noe-edit-modal-close:hover {
    color: #000;
    }
    .noe-status-header {
    background: #2c0078;
    color: white;
    padding: 8px 14px;
    margin-top: 15px;
    margin-bottom: 10px;
    border-radius: 6px;
    font-weight: 600;
    }
    .noe-status-active {
    border-left: 5px solid #44b261;
    }
    .noe-status-upcoming {
    border-left: 5px solid #4a90e2;
    }
    .noe-status-finished {
    border-left: 5px solid #c7b2f7;
    }
    .noe-status-overrunning {
    border-left: 5px solid #ff4444;
    }
    .noe-status-indicator {
    display: inline-block;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.8rem;
    margin-left: 5px;
    color: white;
    }
    .status-active {
    background-color: #44b261;
    }
    .status-upcoming {
    background-color: #4a90e2;
    }
    .status-finished {
    background-color: #c7b2f7;
    }
    .status-overrunning {
    background-color: #ff4444;
    }
    .route-noes {
    margin-top: 15px;
    padding: 10px;
    background: #f5f0ff;
    border-radius: 6px;
    border-left: 5px solid #ff44d0;
    }
    .route-noes h4 {
    margin: 0 0 10px 0;
    font-size: 1rem;
    color: #2c0078;
    }
    @media (max-width: 600px) {
    .container {padding: 12px 2vw; max-width: 100vw;}
    .logo {width: 48vw; max-width: 225px;}
    .tab { font-size: 0.95rem; padding: 10px 0; min-width: 100px; }
    .handover-content textarea { height: 300px; font-size: 0.9rem; }
    textarea { height: 80px; }
    .route-note p { font-size: 0.9rem; }
    .route-note .delete-btn, .route-note .edit-btn, .route-note .copy-btn, .route-note .push-btn { padding: 3px 6px; font-size: 0.85rem; }
    .noe-list li { align-items: center; }
    .noe-list button { min-width: 60px; }
    .routes-checkbox-container { max-height: 80px; }
    .routes-checkbox-container label { font-size: 0.9rem; }
    .date-inputs {
    flex-direction: column;
    gap: 5px;
    }
    .noe-edit-modal-content {
    width: 90%;
    margin: 30% auto;
    }
    }
  </style>
</head>
<body>
  <div class="container">
    <img src="https://www.firstbus.co.uk/themes/custom/first_bus/logo.svg" class="logo" alt="First Bus Logo">
    <div class="tabs">
    <div class="tab active" data-tab="access">Quick Access</div>
    <div class="tab" data-tab="noes">NOE's</div>
    <div class="tab" data-tab="toilet">Toilet Codes</div>
    <div class="tab" data-tab="handover">Midnight Handover</div>
    <div class="tab" data-tab="route-info">Route Info</div>
    <div class="tab" data-tab="driving-hours">Driving Hours</div>
    <div class="tab" data-tab="overtime">Overtime Form</div>
    </div>

    <!-- Tab 1: Quick Access -->
    <!-- ...[rest of your HTML remains unchanged]... -->
    <!-- Tab 7: Overtime Form -->
    <div class="tab-content" id="tab-overtime">
    <form id="overtime-form">
    <div class="dropdown-section">
    <label for="dutyNumber">Duty Number</label>
    <input type="text" id="dutyNumber" name="dutyNumber" required>
    </div>
    
    <div class="dropdown-section">
    <label for="employeeNumber">Employee Number</label>
    <input type="text" id="employeeNumber" name="employeeNumber" required>
    </div>
    
    <div class="dropdown-section">
    <label for="totalTimeDriven">Total Time Driven (before OT)</label>
    <input type="text" id="totalTimeDriven" name="totalTimeDriven" placeholder="e.g., 8h 30m" required>
    </div>
    
    <div class="dropdown-section">
    <label for="routes">OG Route / OT Route</label>
    <input type="text" id="routes" name="routes" placeholder="e.g., 71 / 110" required>
    </div>
    
    <div class="dropdown-section">
    <label for="otStartTime">OT Start Time</label>
    <input type="time" id="otStartTime" name="otStartTime" required>
    </div>
    
    <div class="dropdown-section">
    <label for="otEndTime">OT End Time</label>
    <input type="time" id="otEndTime" name="otEndTime" required>
    </div>
    
    <div class="dropdown-section">
    <label for="approvedBy">Approved By</label>
    <input type="text" id="approvedBy" name="approvedBy" required>
    </div>
    
    <div class="dropdown-section">
    <label for="overtimeDate">Date</label>
    <input type="date" id="overtimeDate" name="overtimeDate" required>
    </div>
    
    <div class="dropdown-section">
    <label for="additionalNotes">Additional Notes</label>
    <textarea id="additionalNotes" name="additionalNotes" placeholder="Any additional information..."></textarea>
    </div>
    
    <div class="actions">
    <button type="button" id="generate-pdf">Generate PDF</button>
    <button type="button" id="send-email">Send Email</button>
    </div>
    </form>
    </div>

    <div class="footer">
    © First Bus – Quick Access Portal
    </div>
  </div>

  <script>
    // ...[all your existing scripts above remain unchanged]...
  </script>
  
  <!-- Overtime Form JavaScript -->
  <script src="overtime.js"></script>

  <!-- Overtime Form Button Logic (added by AI) -->
  <script>
    // Overtime Form PDF and Email logic
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('overtime-form');
      if (!form) return;

      const pdfBtn = document.getElementById('generate-pdf');
      const emailBtn = document.getElementById('send-email');

      // Helper to get form data as object
      function getFormData() {
        return {
          'Duty Number': form.dutyNumber.value,
          'Employee Number': form.employeeNumber.value,
          'Total Time Driven (before OT)': form.totalTimeDriven.value,
          'OG Route / OT Route': form.routes.value,
          'OT Start Time': form.otStartTime.value,
          'OT End Time': form.otEndTime.value,
          'Approved By': form.approvedBy.value,
          'Date': form.overtimeDate.value,
          'Additional Notes': form.additionalNotes.value
        };
      }

      // PDF Generation
      pdfBtn.addEventListener('click', async function() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        // Try to load the local logo, fallback to online SVG
        let logoDataUrl = null;
        try {
          const response = await fetch('firstbuslogo.png');
          if (response.ok) {
            const blob = await response.blob();
            logoDataUrl = await new Promise(resolve => {
              const reader = new FileReader();
              reader.onload = () => resolve(reader.result);
              reader.readAsDataURL(blob);
            });
          }
        } catch (e) {}

        if (!logoDataUrl) {
          // fallback to SVG online
          logoDataUrl = 'https://www.firstbus.co.uk/themes/custom/first_bus/logo.svg';
        }

        // Add logo
        if (logoDataUrl.endsWith('.svg')) {
          // SVG can't be embedded directly, so just add text fallback
          doc.setFontSize(18);
          doc.text('First Bus', 105, 20, { align: 'center' });
        } else {
          doc.addImage(logoDataUrl, 'PNG', 60, 10, 90, 25);
        }

        doc.setFontSize(16);
        doc.text('Overtime Form', 105, 45, { align: 'center' });

        doc.setFontSize(12);
        const data = getFormData();
        let y = 60;
        for (const [label, value] of Object.entries(data)) {
          doc.text(`${label}: ${value || ''}`, 20, y);
          y += 10;
        }

        doc.save('Overtime_Form.pdf');
      });

      // Email logic
      emailBtn.addEventListener('click', function() {
        const data = getFormData();
        let body = '';
        for (const [label, value] of Object.entries(data)) {
          body += `${label}: ${value || ''}\n`;
        }
        const subject = encodeURIComponent('Overtime Form Submission');
        const bodyEncoded = encodeURIComponent(body);

        // Open Outlook web client
        window.open(`https://outlook.office.com/mail/deeplink/compose?subject=${subject}&body=${bodyEncoded}`, '_blank');
      });
    });
  </script>

<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'93e7ac559e8ded7c',t:'MTc0NzAyOTM4OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
''')
print('index.html created')
