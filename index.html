<!-- ...[all your existing code above remains unchanged]... -->

  <!-- Overtime Form JavaScript -->
  <script src="overtime.js"></script>

  <!-- Overtime Form Button Logic (added by AI) -->
  <script>
    // Overtime Form PDF and Email logic
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('overtime-form');
      if (!form) return;

      const pdfBtn = document.getElementById('generate-pdf');
      const emailBtn = document.getElementById('send-email');

      // Helper to get form data as object
      function getFormData() {
        return {
          'Duty Number': form.dutyNumber.value,
          'Employee Number': form.employeeNumber.value,
          'Total Time Driven (before OT)': form.totalTimeDriven.value,
          'OG Route / OT Route': form.routes.value,
          'OT Start Time': form.otStartTime.value,
          'OT End Time': form.otEndTime.value,
          'Approved By': form.approvedBy.value,
          'Date': form.overtimeDate.value,
          'Additional Notes': form.additionalNotes.value
        };
      }

      // PDF Generation
      pdfBtn.addEventListener('click', async function() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        // Try to load the local logo, fallback to online SVG
        let logoDataUrl = null;
        try {
          const response = await fetch('firstbuslogo.png');
          if (response.ok) {
            const blob = await response.blob();
            logoDataUrl = await new Promise(resolve => {
              const reader = new FileReader();
              reader.onload = () => resolve(reader.result);
              reader.readAsDataURL(blob);
            });
          }
        } catch (e) {}

        if (!logoDataUrl) {
          // fallback to SVG online
          logoDataUrl = 'https://www.firstbus.co.uk/themes/custom/first_bus/logo.svg';
        }

        // Add logo
        if (logoDataUrl.endsWith('.svg')) {
          // SVG can't be embedded directly, so just add text fallback
          doc.setFontSize(18);
          doc.text('First Bus', 105, 20, { align: 'center' });
        } else {
          doc.addImage(logoDataUrl, 'PNG', 60, 10, 90, 25);
        }

        doc.setFontSize(16);
        doc.text('Overtime Form', 105, 45, { align: 'center' });

        doc.setFontSize(12);
        const data = getFormData();
        let y = 60;
        for (const [label, value] of Object.entries(data)) {
          doc.text(`${label}: ${value || ''}`, 20, y);
          y += 10;
        }

        doc.save('Overtime_Form.pdf');
      });

      // Email logic
      emailBtn.addEventListener('click', function() {
        const data = getFormData();
        let body = '';
        for (const [label, value] of Object.entries(data)) {
          body += `${label}: ${value || ''}\n`;
        }
        const subject = encodeURIComponent('Overtime Form Submission');
        const bodyEncoded = encodeURIComponent(body);

        // Open Outlook web client
        window.open(`https://outlook.office.com/mail/deeplink/compose?subject=${subject}&body=${bodyEncoded}`, '_blank');
      });
    });
  </script>

<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'93e7ac559e8ded7c',t:'MTc0NzAyOTM4OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
